{"ast":null,"code":"var _jsxFileName = \"/Users/tuphan/Desktop/ubuntuGcalls/client/src/App.js\",\n    _s = $RefreshSig$();\n\nimport \"./App.css\";\nimport deleteIcon from \"./image/delete.png\";\nimport callIcon from \"./image/call.png\";\nimport endIcon from \"./image/end.png\";\nimport muteIcon from \"./image/mute.png\";\nimport audioIcon from \"./image/audio.png\";\nimport React, { useState, useEffect, Component } from \"react\";\nimport JsSIP from \"jssip\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nrequire('dotenv').config();\n\nJsSIP.debug.disable(\"JsSIP:*\");\nvar socket;\nvar configuration;\nvar ua;\nfetch(`/api/key`).then(response => response.json()).then(state => {\n  socket = new JsSIP.WebSocketInterface(state.ws);\n  configuration = {\n    sockets: [socket],\n    uri: state.uri,\n    password: state.password,\n    session_timers: false\n  };\n  ua = new JsSIP.UA(configuration);\n  ua.start();\n});\nvar pos;\nlet duration = 0;\nvar timer;\nlet address = \"Unknown\";\nlet internetProtocol = \"Unknown\";\nconst ipUrl = \"https://api.ipify.org?format=json\";\nfetch(ipUrl).then(response => response.json()).then(jsonData => {\n  // jsonData is parsed json object received from url\n  internetProtocol = jsonData.ip;\n}).catch(error => {\n  // handle your errors here\n  console.error(error);\n});\nnavigator.geolocation.getCurrentPosition(function (position) {\n  pos = {\n    lng: position.coords.longitude,\n    lat: position.coords.latitude\n  };\n  const url = \"https://api.mapbox.com/geocoding/v5/mapbox.places/\" + pos.lng + \",\" + pos.lat + \".json?access_token=pk.eyJ1IjoidHVzcGhhbmFuaCIsImEiOiJja244eDFyMGkwM3R5MnVvbzI1eWZsYzNuIn0.jm4MGKDtKDMBpLz8IUXyAA\";\n  fetch(url).then(response => response.json()).then(jsonData => {\n    // jsonData is parsed json object received from url\n    address = jsonData.features[0].place_name;\n  }).catch(error => {\n    // handle your errors here\n    console.error(error);\n  });\n}); // Register callbacks to desired call events\n\nvar eventHandlers = {\n  progress: function (e) {\n    console.log(\"call is in progress\");\n    showCallingContainer();\n    setStatusText(\"Ringing\");\n  },\n  failed: function (e) {\n    console.log(\"call failed with cause \");\n    setCallButton();\n    setStatusText(\"Call Fail\");\n\n    if (timer) {\n      clearInterval(timer);\n      duration = 0;\n    }\n\n    audio = null;\n    session = null;\n  },\n  ended: function (e) {\n    console.log(\"call ended with cause \");\n    setCallButton();\n    setStatusText(\"Call End\");\n\n    if (timer) {\n      clearInterval(timer);\n      duration = 0;\n    }\n\n    audio = null;\n    session = null;\n  },\n  confirmed: function (e) {\n    console.log(\"call confirmed\");\n    timer = setInterval(() => {\n      setStatusText(fomatDuration(duration));\n      duration++;\n    }, 1000);\n  }\n};\nvar options = {\n  eventHandlers: eventHandlers,\n  mediaConstraints: {\n    audio: true,\n    video: false\n  }\n};\nvar session;\nvar audio;\n\nfunction startCallAudio(phoneNumber) {\n  session = ua.call(phoneNumber, options);\n\n  if (session) {\n    session.connection.addEventListener(\"addstream\", e => {\n      audio = document.createElement(\"audio\");\n      audio.srcObject = e.stream;\n      audio.play();\n    });\n  }\n}\n\nfunction fomatDuration(time) {\n  // Hours, minutes and seconds\n  var secs = ~~time % 60;\n  var mins = ~~(time / 60); // Output like \"1:01\" or \"4:03:59\" or \"123:03:59\"\n\n  var ret = \"\";\n\n  if (mins > 9) {\n    ret += \"\" + mins + \":\" + (secs < 10 ? \"0\" : \"\");\n  } else {\n    ret += \"0\" + mins + \":\" + (secs < 10 ? \"0\" : \"\");\n  }\n\n  ret += \"\" + secs;\n  return ret;\n}\n\nfunction setStatusText(status) {\n  const statusText = document.getElementById(\"status-text\");\n  statusText.innerHTML = status;\n}\n\nfunction setCallButton() {\n  const callButton = document.getElementById(\"call-button\");\n  const bol = callButton.getAttribute(\"iscalling\"); // Incall\n\n  if (bol === \"true\") {\n    if (session) {\n      ua.terminateSessions(options);\n    }\n\n    callButton.setAttribute(\"iscalling\", \"false\");\n    showNumpad();\n  } // OutCall\n  else {\n      callButton.setAttribute(\"iscalling\", \"true\");\n      showCallingContainer();\n    }\n}\n\nfunction onAudio(e) {\n  const target = e.target;\n\n  if (target.getAttribute(\"isactive\") === \"true\") {\n    audio.muted = true;\n    target.style.opacity = \"0.6\";\n    target.setAttribute(\"isactive\", \"false\");\n  } else {\n    audio.muted = false;\n    target.style.opacity = \"1\";\n    target.setAttribute(\"isactive\", \"true\");\n  }\n}\n\nfunction onMute(e) {\n  const target = e.target;\n\n  if (target.getAttribute(\"isactive\") === \"true\") {\n    target.style.opacity = \"0.6\";\n    target.setAttribute(\"isactive\", \"false\");\n\n    if (session) {\n      session.mute({\n        audio: true\n      });\n    }\n  } else {\n    target.style.opacity = \"1\";\n    target.setAttribute(\"isactive\", \"true\");\n\n    if (session) {\n      session.unmute({\n        audio: true\n      });\n    }\n  }\n}\n\nfunction hideCallingContainer() {\n  const callingContainer = document.getElementById(\"calling-container\");\n  callingContainer.style.animation = \"hide  1.5s forwards\";\n  callingContainer.addEventListener(\"animationend\", () => {\n    callingContainer.style.animation = \"\";\n    callingContainer.style.display = \"none\";\n    callingContainer.style.opacity = \"0\";\n  });\n}\n\nfunction showCallingContainer() {\n  const deleteButton = document.getElementById(\"delete-button\");\n  const callingContainer = document.getElementById(\"calling-container\");\n  callingContainer.style.display = \"flex\";\n  callingContainer.style.animation = \"show  1.5s forwards\";\n  callingContainer.addEventListener(\"animationend\", () => {\n    callingContainer.style.animation = \"\";\n    callingContainer.style.display = \"flex\";\n    callingContainer.style.opacity = \"1\";\n  });\n  deleteButton.style.opacity = \"0\";\n  deleteButton.style.pointerEvents = \"none\";\n  hideNumpad();\n  const callButton = document.getElementById(\"call-button\");\n  callButton.src = endIcon;\n}\n\nfunction hideNumpad() {\n  const numpad = document.getElementById(\"numpad\");\n  numpad.style.animation = \"hide  1.5s forwards\";\n  numpad.addEventListener(\"animationend\", () => {\n    numpad.style.animation = \"\";\n    numpad.style.display = \"none\";\n    numpad.style.opacity = \"0\";\n  });\n}\n\nfunction showNumpad() {\n  const deleteButton = document.getElementById(\"delete-button\");\n  const numpad = document.getElementById(\"numpad\");\n  numpad.style.display = \"flex\";\n  numpad.style.animation = \"show  1.5s forwards\";\n  numpad.addEventListener(\"animationend\", () => {\n    numpad.style.animation = \"\";\n    numpad.style.display = \"flex\";\n    numpad.style.opacity = \"1\";\n  });\n  deleteButton.style.opacity = \"1\";\n  deleteButton.style.pointerEvents = \"auto\";\n  hideCallingContainer();\n  const callButton = document.getElementById(\"call-button\");\n  callButton.src = callIcon;\n}\n\nconst getDevice = () => {\n  let device = \"Unknown\";\n  const ua = {\n    \"Generic Linux\": /Linux/i,\n    Android: /Android/i,\n    BlackBerry: /BlackBerry/i,\n    Bluebird: /EF500/i,\n    \"Chrome OS\": /CrOS/i,\n    Datalogic: /DL-AXIS/i,\n    Honeywell: /CT50/i,\n    iPad: /iPad/i,\n    iPhone: /iPhone/i,\n    iPod: /iPod/i,\n    macOS: /Macintosh/i,\n    Windows: /IEMobile|Windows/i,\n    Zebra: /TC70|TC55/i\n  };\n  Object.keys(ua).map(v => navigator.userAgent.match(ua[v]) && (device = v));\n  return device.charAt(0).toUpperCase() + device.slice(1);\n};\n\nfunction App() {\n  _s();\n\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\n\n  function call(e) {\n    const target = e.target;\n\n    if (target === e.currentTarget) {\n      target.style.animation = \"fade 0.5s forwards\";\n      target.addEventListener(\"animationend\", () => {\n        target.style.animation = \"\";\n      });\n\n      if (phoneNumber != \"\") {\n        startCallAudio(phoneNumber);\n        setCallButton();\n      }\n    }\n  }\n\n  function click(e) {\n    const target = e.target;\n\n    if (target === e.currentTarget) {\n      target.style.animation = \"fade 0.5s forwards\";\n      target.addEventListener(\"animationend\", () => {\n        target.style.animation = \"\";\n      });\n      setPhoneNumber(phoneNumber + target.attributes.getNamedItem(\"value\").value);\n    }\n  }\n\n  function deleteNum(e) {\n    setPhoneNumber(phoneNumber.slice(0, -1));\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"phone\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"wrapper\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          id: \"phone-number\",\n          number: \"\",\n          children: phoneNumber\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"function-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"numpad\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"button-container\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: click,\n                className: \"key\",\n                value: \"1\",\n                children: [\"1\", /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"\\xA0\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 335,\n                  columnNumber: 20\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 334,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: click,\n                className: \"key\",\n                value: \"2\",\n                children: [\"2\", /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"abc\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 338,\n                  columnNumber: 20\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 337,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: click,\n                className: \"key\",\n                value: \"3\",\n                children: [\"3\", /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"def\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 341,\n                  columnNumber: 20\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 340,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 333,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"button-container\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: click,\n                className: \"key\",\n                value: \"4\",\n                children: [\"4\", /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"ghi\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 347,\n                  columnNumber: 20\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 346,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: click,\n                className: \"key\",\n                value: \"5\",\n                children: [\"5\", /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"jkl\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 350,\n                  columnNumber: 20\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 349,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: click,\n                className: \"key\",\n                value: \"6\",\n                children: [\"6\", /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"mno\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 353,\n                  columnNumber: 20\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 352,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"button-container\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: click,\n                className: \"key\",\n                value: \"7\",\n                children: [\"7\", /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"pqrs\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 358,\n                  columnNumber: 20\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 357,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: click,\n                className: \"key\",\n                value: \"8\",\n                children: [\"8\", /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"tuv\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 361,\n                  columnNumber: 20\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 360,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: click,\n                className: \"key\",\n                value: \"9\",\n                children: [\"9\", /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"wxyz\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 364,\n                  columnNumber: 20\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 363,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 356,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"button-container\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: click,\n                id: \"special-button-left\",\n                className: \"key special\",\n                value: \"*\",\n                children: \"*\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 368,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: click,\n                className: \"key\",\n                value: \"0\",\n                children: [\"0\", /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"+\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 377,\n                  columnNumber: 20\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 376,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                onClick: click,\n                id: \"special-button-right\",\n                className: \"key special\",\n                value: \"#\",\n                children: \"#\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 379,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 367,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            id: \"calling-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              id: \"status-text\",\n              style: {\n                fontWeight: \"bold\"\n              },\n              children: \"Ringing\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 390,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              id: \"device-text\",\n              style: {\n                margin: \"3px\"\n              },\n              children: getDevice()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 394,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              id: \"ip-text\",\n              style: {\n                margin: \"3px\"\n              },\n              children: internetProtocol\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 402,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              id: \"location-text\",\n              style: {\n                margin: \"3px\"\n              },\n              children: address\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 410,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"button-container\",\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                id: \"mute-button\",\n                onClick: onMute,\n                isactive: \"true\",\n                src: muteIcon,\n                alt: \"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 419,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n                id: \"audio-button\",\n                onClick: onAudio,\n                isactive: \"true\",\n                src: audioIcon,\n                alt: \"\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 426,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 418,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 389,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"button-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: \"75px\",\n              height: \"75px\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 438,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n            id: \"call-button\",\n            iscalling: \"false\",\n            onClick: call,\n            style: {\n              width: \"65px\",\n              height: \"65px\",\n              margin: \"10px\",\n              padding: 0\n            },\n            src: callIcon,\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 439,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n            id: \"delete-button\",\n            onClick: deleteNum,\n            style: {\n              width: \"25px\",\n              margin: \"13px\",\n              paddingLeft: \"20px\"\n            },\n            src: deleteIcon,\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 452,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 437,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 325,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"B4/QWViiwe0BGqmwp3qAZAV0Axo=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/Users/tuphan/Desktop/ubuntuGcalls/client/src/App.js"],"names":["deleteIcon","callIcon","endIcon","muteIcon","audioIcon","React","useState","useEffect","Component","JsSIP","require","config","debug","disable","socket","configuration","ua","fetch","then","response","json","state","WebSocketInterface","ws","sockets","uri","password","session_timers","UA","start","pos","duration","timer","address","internetProtocol","ipUrl","jsonData","ip","catch","error","console","navigator","geolocation","getCurrentPosition","position","lng","coords","longitude","lat","latitude","url","features","place_name","eventHandlers","progress","e","log","showCallingContainer","setStatusText","failed","setCallButton","clearInterval","audio","session","ended","confirmed","setInterval","fomatDuration","options","mediaConstraints","video","startCallAudio","phoneNumber","call","connection","addEventListener","document","createElement","srcObject","stream","play","time","secs","mins","ret","status","statusText","getElementById","innerHTML","callButton","bol","getAttribute","terminateSessions","setAttribute","showNumpad","onAudio","target","muted","style","opacity","onMute","mute","unmute","hideCallingContainer","callingContainer","animation","display","deleteButton","pointerEvents","hideNumpad","src","numpad","getDevice","device","Android","BlackBerry","Bluebird","Datalogic","Honeywell","iPad","iPhone","iPod","macOS","Windows","Zebra","Object","keys","map","v","userAgent","match","charAt","toUpperCase","slice","App","setPhoneNumber","currentTarget","click","attributes","getNamedItem","value","deleteNum","fontWeight","margin","width","height","padding","paddingLeft"],"mappings":"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","sourcesContent":["import \"./App.css\";\nimport deleteIcon from \"./image/delete.png\";\nimport callIcon from \"./image/call.png\";\nimport endIcon from \"./image/end.png\";\nimport muteIcon from \"./image/mute.png\";\nimport audioIcon from \"./image/audio.png\";\nimport React, { useState, useEffect, Component } from \"react\";\nimport JsSIP from \"jssip\";\nrequire('dotenv').config()\n\nJsSIP.debug.disable(\"JsSIP:*\");\nvar socket\nvar configuration\nvar ua\n\nfetch(`/api/key`).then(response => response.json()).then(state =>{\n  socket = new JsSIP.WebSocketInterface(state.ws);\n  configuration = {\n    sockets: [socket],\n    uri: state.uri,\n    password: state.password,\n    session_timers: false,\n  };\n  \n\n  ua = new JsSIP.UA(configuration);\n  ua.start();\n});\n\nvar pos;\nlet duration = 0;\nvar timer;\nlet address = \"Unknown\";\nlet internetProtocol  = \"Unknown\";\nconst ipUrl =\"https://api.ipify.org?format=json\";\n\n \n  fetch(ipUrl)\n    .then((response) => response.json())\n    .then((jsonData) => {\n      // jsonData is parsed json object received from url\n      \n      internetProtocol = jsonData.ip\n\n    })\n    .catch((error) => {\n      // handle your errors here\n      console.error(error);\n    });\nnavigator.geolocation.getCurrentPosition(function (position) {\n  pos = {\n    lng: position.coords.longitude,\n    lat: position.coords.latitude,\n  };\n \n  const url =\n    \"https://api.mapbox.com/geocoding/v5/mapbox.places/\" +\n    pos.lng +\n    \",\" +\n    pos.lat +\n    \".json?access_token=pk.eyJ1IjoidHVzcGhhbmFuaCIsImEiOiJja244eDFyMGkwM3R5MnVvbzI1eWZsYzNuIn0.jm4MGKDtKDMBpLz8IUXyAA\";\n\n  fetch(url)\n    .then((response) => response.json())\n    .then((jsonData) => {\n      // jsonData is parsed json object received from url\n      address = jsonData.features[0].place_name;\n    })\n    .catch((error) => {\n      // handle your errors here\n      console.error(error);\n    });\n\n});\n\n\n// Register callbacks to desired call events\nvar eventHandlers = {\n  progress: function (e) {\n    console.log(\"call is in progress\");\n    showCallingContainer();\n    setStatusText(\"Ringing\");\n   \n  },\n  failed: function (e) {\n    console.log(\"call failed with cause \");\n    setCallButton();\n    setStatusText(\"Call Fail\");\n    if (timer) {\n      clearInterval(timer);\n      duration = 0;\n    }\n    audio = null\n    session = null\n  },\n  ended: function (e) {\n    console.log(\"call ended with cause \");\n    setCallButton();\n    setStatusText(\"Call End\");\n    if (timer) {\n      clearInterval(timer);\n      duration = 0;\n    }\n    audio = null\n    session = null\n  },\n  confirmed: function (e) {\n    console.log(\"call confirmed\");\n    timer = setInterval(() => {\n    \n      setStatusText(fomatDuration(duration));\n      duration++;\n    }, 1000);\n  },\n};\n\n\nvar options = {\n  eventHandlers: eventHandlers,\n  mediaConstraints: { audio: true, video: false },\n};\nvar session;\nvar audio;\nfunction startCallAudio(phoneNumber) {\n  session = ua.call(phoneNumber, options);\n  if (session) {\n    session.connection.addEventListener(\"addstream\", (e) => {\n      audio = document.createElement(\"audio\");\n      audio.srcObject = e.stream;\n      audio.play();\n    });\n  }\n}\n\n\nfunction fomatDuration(time) {\n  // Hours, minutes and seconds\n\n  var secs = ~~time % 60;\n  var mins = ~~(time / 60);\n  // Output like \"1:01\" or \"4:03:59\" or \"123:03:59\"\n  var ret = \"\";\n\n  if (mins > 9) {\n    ret += \"\" + mins + \":\" + (secs < 10 ? \"0\" : \"\");\n  } else {\n    ret += \"0\" + mins + \":\" + (secs < 10 ? \"0\" : \"\");\n  }\n\n  ret += \"\" + secs;\n  return ret;\n}\n\nfunction setStatusText(status) {\n  const statusText = document.getElementById(\"status-text\");\n  statusText.innerHTML = status;\n}\n\nfunction setCallButton() {\n  const callButton = document.getElementById(\"call-button\");\n  const bol = callButton.getAttribute(\"iscalling\");\n  // Incall\n  if (bol === \"true\") {\n    if (session) {\n      ua.terminateSessions(options);\n    }\n    callButton.setAttribute(\"iscalling\", \"false\");\n    showNumpad();\n  }\n  // OutCall\n  else {\n    callButton.setAttribute(\"iscalling\", \"true\");\n    showCallingContainer();\n  }\n}\n\nfunction onAudio(e) {\n  \n  const target = e.target;\n  if (target.getAttribute(\"isactive\") === \"true\") {\n    audio.muted = true;\n    target.style.opacity = \"0.6\";\n    target.setAttribute(\"isactive\", \"false\");\n  } else {\n    audio.muted = false;\n    target.style.opacity = \"1\";\n    target.setAttribute(\"isactive\", \"true\");\n  }\n}\n\nfunction onMute(e) {\n \n  const target = e.target;\n  if (target.getAttribute(\"isactive\") === \"true\") {\n    target.style.opacity = \"0.6\";\n    target.setAttribute(\"isactive\", \"false\");\n    if (session) {\n      session.mute({ audio: true });\n    }\n  } else {\n    target.style.opacity = \"1\";\n    target.setAttribute(\"isactive\", \"true\");\n    if (session) {\n      session.unmute({ audio: true });\n    }\n  }\n}\n\nfunction hideCallingContainer() {\n  const callingContainer = document.getElementById(\"calling-container\");\n  callingContainer.style.animation = \"hide  1.5s forwards\";\n  callingContainer.addEventListener(\"animationend\", () => {\n    callingContainer.style.animation = \"\";\n    callingContainer.style.display = \"none\";\n    callingContainer.style.opacity = \"0\";\n  });\n}\n\nfunction showCallingContainer() {\n  const deleteButton = document.getElementById(\"delete-button\");\n  const callingContainer = document.getElementById(\"calling-container\");\n  callingContainer.style.display = \"flex\";\n  callingContainer.style.animation = \"show  1.5s forwards\";\n  callingContainer.addEventListener(\"animationend\", () => {\n    callingContainer.style.animation = \"\";\n    callingContainer.style.display = \"flex\";\n    callingContainer.style.opacity = \"1\";\n  });\n\n  deleteButton.style.opacity = \"0\";\n  deleteButton.style.pointerEvents = \"none\";\n  hideNumpad();\n\n  const callButton = document.getElementById(\"call-button\");\n  callButton.src = endIcon;\n}\n\nfunction hideNumpad() {\n  const numpad = document.getElementById(\"numpad\");\n  numpad.style.animation = \"hide  1.5s forwards\";\n  numpad.addEventListener(\"animationend\", () => {\n    numpad.style.animation = \"\";\n    numpad.style.display = \"none\";\n    numpad.style.opacity = \"0\";\n  });\n}\n\nfunction showNumpad() {\n  const deleteButton = document.getElementById(\"delete-button\");\n  const numpad = document.getElementById(\"numpad\");\n\n  numpad.style.display = \"flex\";\n  numpad.style.animation = \"show  1.5s forwards\";\n  numpad.addEventListener(\"animationend\", () => {\n    numpad.style.animation = \"\";\n    numpad.style.display = \"flex\";\n    numpad.style.opacity = \"1\";\n  });\n  deleteButton.style.opacity = \"1\";\n  deleteButton.style.pointerEvents = \"auto\";\n  hideCallingContainer();\n\n  const callButton = document.getElementById(\"call-button\");\n  callButton.src = callIcon;\n}\n\nconst getDevice = () => {\n  let device = \"Unknown\";\n  const ua = {\n    \"Generic Linux\": /Linux/i,\n    Android: /Android/i,\n    BlackBerry: /BlackBerry/i,\n    Bluebird: /EF500/i,\n    \"Chrome OS\": /CrOS/i,\n    Datalogic: /DL-AXIS/i,\n    Honeywell: /CT50/i,\n    iPad: /iPad/i,\n    iPhone: /iPhone/i,\n    iPod: /iPod/i,\n    macOS: /Macintosh/i,\n    Windows: /IEMobile|Windows/i,\n    Zebra: /TC70|TC55/i,\n  };\n  Object.keys(ua).map((v) => navigator.userAgent.match(ua[v]) && (device = v));\n  return device.charAt(0).toUpperCase() + device.slice(1);\n};\n\nfunction App() {\n  const [phoneNumber, setPhoneNumber] = useState(\"\");\n\n  function call(e) {\n    const target = e.target;\n\n    if (target === e.currentTarget) {\n      target.style.animation = \"fade 0.5s forwards\";\n      target.addEventListener(\"animationend\", () => {\n        target.style.animation = \"\";\n      });\n\n      if (phoneNumber != \"\") {\n        startCallAudio(phoneNumber);\n        setCallButton();\n      }\n    }\n  }\n\n  function click(e) {\n    const target = e.target;\n\n    if (target === e.currentTarget) {\n      target.style.animation = \"fade 0.5s forwards\";\n      target.addEventListener(\"animationend\", () => {\n        target.style.animation = \"\";\n      });\n      setPhoneNumber(\n        phoneNumber + target.attributes.getNamedItem(\"value\").value\n      );\n      \n    }\n  }\n  function deleteNum(e) {\n    setPhoneNumber(phoneNumber.slice(0, -1));\n  }\n  return (\n    <div className=\"App\">\n      <div id=\"phone\">\n        <div id=\"wrapper\">\n          <p id=\"phone-number\" number=\"\">\n            {phoneNumber}\n          </p>\n          <div id=\"function-container\">\n            <div id=\"numpad\">\n              <div className=\"button-container\">\n                <div onClick={click} className=\"key\" value=\"1\">\n                  1<span>&nbsp;</span>\n                </div>\n                <div onClick={click} className=\"key\" value=\"2\">\n                  2<span>abc</span>\n                </div>\n                <div onClick={click} className=\"key\" value=\"3\">\n                  3<span>def</span>\n                </div>\n              </div>\n\n              <div className=\"button-container\">\n                <div onClick={click} className=\"key\" value=\"4\">\n                  4<span>ghi</span>\n                </div>\n                <div onClick={click} className=\"key\" value=\"5\">\n                  5<span>jkl</span>\n                </div>\n                <div onClick={click} className=\"key\" value=\"6\">\n                  6<span>mno</span>\n                </div>\n              </div>\n              <div className=\"button-container\">\n                <div onClick={click} className=\"key\" value=\"7\">\n                  7<span>pqrs</span>\n                </div>\n                <div onClick={click} className=\"key\" value=\"8\">\n                  8<span>tuv</span>\n                </div>\n                <div onClick={click} className=\"key\" value=\"9\">\n                  9<span>wxyz</span>\n                </div>\n              </div>\n              <div className=\"button-container\">\n                <div\n                  onClick={click}\n                  id=\"special-button-left\"\n                  className=\"key special\"\n                  value=\"*\"\n                >\n                  *\n                </div>\n                <div onClick={click} className=\"key\" value=\"0\">\n                  0<span>+</span>\n                </div>\n                <div\n                  onClick={click}\n                  id=\"special-button-right\"\n                  className=\"key special\"\n                  value=\"#\"\n                >\n                  #\n                </div>\n              </div>\n            </div>\n            <div id=\"calling-container\">\n              <p id=\"status-text\" style={{ fontWeight: \"bold\" }}>\n                Ringing\n              </p>\n              \n              <p\n                id=\"device-text\"\n                style={{\n                  margin: \"3px\",\n                }}\n              >\n                {getDevice()}\n              </p>\n              <p\n                id=\"ip-text\"\n                style={{\n                  margin: \"3px\",\n                }}\n              >\n                {internetProtocol}\n              </p>\n              <p\n                id=\"location-text\"\n                style={{\n                  margin: \"3px\",\n                }}\n              >\n                {address}\n              </p>\n              <div className=\"button-container\">\n                <img\n                  id=\"mute-button\"\n                  onClick={onMute}\n                  isactive=\"true\"\n                  src={muteIcon}\n                  alt=\"\"\n                />\n                <img\n                  id=\"audio-button\"\n                  onClick={onAudio}\n                  isactive=\"true\"\n                  src={audioIcon}\n                  alt=\"\"\n                />\n              </div>\n            </div>\n          </div>\n\n          <div className=\"button-container\">\n            <div style={{ width: \"75px\", height: \"75px\" }}></div>\n            <img\n              id=\"call-button\"\n              iscalling=\"false\"\n              onClick={call}\n              style={{\n                width: \"65px\",\n                height: \"65px\",\n                margin: \"10px\",\n                padding: 0,\n              }}\n              src={callIcon}\n              alt=\"\"\n            />\n            <img\n              id=\"delete-button\"\n              onClick={deleteNum}\n              style={{ width: \"25px\", margin: \"13px\", paddingLeft: \"20px\" }}\n              src={deleteIcon}\n              alt=\"\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}